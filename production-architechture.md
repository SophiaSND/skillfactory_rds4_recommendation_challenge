# Архитектура production-сервиса

<!-- vim-markdown-toc Redcarpet -->

* [Общая информация](#общая-информация)
* [Реализации логики переходов](#реализации-логики-переходов)

<!-- vim-markdown-toc -->

## Общая информация

Production-сервис - это [веб-сервис](production-site-map.md)

Оформлен как монолитный docker-контейнер (1.25GB), включающий в себя как логику (Flask) так и данные (sqlite3)

Это позволяет разворачивать его одной командой:

```
docker rm recommend; docker run -it --name recommend -e PORT=9000 -p 42420:9000 bazawinner/prod-recommend-flask:7
```

## Реализации логики [переходов](production-site-map.md)

Логика на Flask/Python описана в одном файле src/flask/main.py размером 440 строк

Реализована обработка трех route'ов:

- корневой (`/`). Отвечает за список товаров для выбора, возможно отфильтрованный/отсортированный. Также отвечает за список выбранных товаров (в корзине).

- фильтры (`/filter-main`). Отвечает за формирование содержимого "выезжающей" страницы с фильрами/параметрами сортироваки списка товаров для выбора

- карточка товара (`/item/<itemid>`). Отвечает за формирование карточки товара, независимо от того, откуда мы в нее перешли (из спииска товаров для выбора, из корзины или из списка рекомендованных товаров). Также отвечает за формирование страницы отзывов на товар.

Все параметры состояния (параметр сортировки, параметры фильтрации, признак корзина/общий список, номер страницы списка товаров/отзывов)











